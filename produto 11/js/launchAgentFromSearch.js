!function(){"use strict";!function(){if(!window.shopperAgentSearchInitialized){window.shopperAgentSearchInitialized=!0;var e=!1,n=!1;window.addEventListener("onEmbeddedMessagingFirstBotMessageSent",function(){n=!0}),window.addEventListener("onEmbeddedMessagingConversationClosed",function(){n=!1});var t=function(){return window.embeddedservice_bootstrap&&"function"==typeof window.embeddedservice_bootstrap.utilAPI.launchChat},o=function(o){if(t()&&!e){o.preventDefault(),o.stopPropagation(),(window.embeddedservice_bootstrap&&window.embeddedservice_bootstrap.settings&&!0===window.embeddedservice_bootstrap.settings.hideChatButtonOnLoad||window.shopperAgentConfig&&(!1===window.shopperAgentConfig.enabledFabEntry||"false"===window.shopperAgentConfig.enabledFabEntry))&&"function"==typeof window.showFabButton&&window.showFabButton(),e=!0;var r=function(){var e=document.querySelector("input.search-field");if(e&&e.value)return e.value;var n=document.querySelector(".suggestions");if(n){var t=n.closest("form");if(t){var o=t.querySelector("input[type='search'], input[name='q']");if(o&&o.value)return o.value}}return""}(),i=null,s=function(){var e=document.querySelector(".suggestions");e&&(e.style.display="none")},d=function(){window.embeddedservice_bootstrap.utilAPI.sendTextMessage(r).then(function(){s()}).catch(function(e){console.error("Shopper Agent: Error sending message",e)}).finally(function(){e=!1})};if(r&&r.trim())if(n)window.embeddedservice_bootstrap.utilAPI.launchChat().then(function(){d()}).catch(function(n){console.error("Shopper Agent: Error opening chat",n),e=!1});else{var a=!1;i=function(){a||(a=!0,n=!0,d(),window.removeEventListener("onEmbeddedMessagingFirstBotMessageSent",i))},window.addEventListener("onEmbeddedMessagingFirstBotMessageSent",i),window.embeddedservice_bootstrap.utilAPI.launchChat().then(function(){!a&&n&&(a=!0,window.removeEventListener("onEmbeddedMessagingFirstBotMessageSent",i),d())}).catch(function(n){console.error("Shopper Agent: Error opening chat",n),window.removeEventListener("onEmbeddedMessagingFirstBotMessageSent",i),e=!1})}else window.embeddedservice_bootstrap.utilAPI.launchChat().then(function(){s(),e=!1}).catch(function(n){console.error("Shopper Agent: Error opening chat",n),e=!1})}};document.addEventListener("click",function(e){e.target&&e.target.closest(".shopper-agent-from-search-banner")&&o(e)}),document.addEventListener("keydown",function(e){e.target&&e.target.closest(".shopper-agent-from-search-banner")&&function(e){"Enter"!==e.key&&" "!==e.key||!t()||(e.preventDefault(),o(e))}(e)})}}()}();